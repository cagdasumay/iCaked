@model EventApp.Models.Map
@using EventApp.Models

@{
    ViewBag.Title = "Haritalar";
    List<Map> MapList = (List<Map>)ViewData["MpsList"];
    List<MapType> maptype = (List<MapType>)ViewData["MapType"];
    int mapcount = maptype.Count;
    List<string> Validations = (List<string>)ViewData["ValidationList"];
    string MapTypeError = Validations[0];
    string MapImageError = Validations[1];
    string MapNameError = Validations[2];
    string UploadTypeError = Validations[3];
    string LattitudeError = Validations[4];
    string LongitudeError = Validations[5];
    Map map = (Map)Session["deletemap"];
    string UsageError = (string)ViewData["UsageError"];
}

<script src="~/scripts/jquery-1.10.2.min.js"></script>

<script type="text/javascript">

        $(document).ready(function () {
            $("#id").change(function () {
                var type = $("#id").val();
                $("#back-btn").attr("href", "/Maps/Delete?id=" + type);
            });

            $("#id").change(function () {
                var type = $("#id").val();
                $("#back-btn").attr("href", "/Maps/Delete?id=" + type);
            });

            setTimeout(function () { $(this).scrollTop(0); }, 1);

            $(".delete-type1").click(function () {
                var hidden = $(this).attr("data-td");
                $("." + hidden).slideToggle(200);
            });
        });

        function selectMap(elem) {
            var selected = $(elem).val().toUpperCase();
            if (selected == "3BF08CF7-C6A7-4A15-B423-2F7014D16E28" | selected == "99AEF609-20FE-4345-9CD9-C09F1D28E2D8") {
                $("#coordinateWrapper").hide(50);  $("#mapWrapper").show(50);
            }
            else if (selected == "B3473DF0-15EE-4A01-84D4-9774AC8F8E6D") {
                $("#mapWrapper").hide(50); $("#coordinateWrapper").show(50);
            }
        }

</script>

<div class="page-content-wrapper">
    <!-- BEGIN CONTENT BODY -->
    <div class="page-content">
        <!-- BEGIN PAGE HEADER-->
        <!-- BEGIN PAGE BAR -->
        <div class="page-bar">
            <ul class="page-breadcrumb">
                <li>
                    <a href="@Url.Action("CreateMap","Maps")">Haritalar</a>
                </li>
            </ul>
        </div>
        <!-- END PAGE BAR -->
        <!-- BEGIN PAGE TITLE-->
        <h1 class="page-title">
            Harita
            <small>Yükle-Düzenle</small>
        </h1>
        <!-- END PAGE TITLE-->
        <!-- END PAGE HEADER-->
        <div class="row">
            <div class="col-md-12">
                <!-- BEGIN EXAMPLE TABLE PORTLET-->
                <div class="portlet light portlet-fit bordered">


                    <div class="portlet-body">
                        @using (Html.BeginForm("CreateMap", "Maps", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {
                            @Html.AntiForgeryToken()
                            <div class="table-toolbar">
                                <div class="row" style="margin-left: 0;">
                                    @{
                                        if (MapTypeError == "MapTypeError")
                                        {
                                            <div class="col-md-2 col-sm-2 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                <select name="TypeOfMap" id="TypeOfMap" class="form-control form-control-solid red col-md-3 col-sm-3 col-xs-6">
                                                    <option value=@Guid.Empty>Harita Formatı Gereklidir!</option>)
                                                    @{
                                                        for (int i = 0; i < mapcount; i++)
                                                        {
                                                            <option value="@maptype[i].Id">@maptype[i].Name</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="col-md-2 col-sm-2 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                <select onchange="selectMap(this)" name="TypeOfMap" id="TypeOfMap" class="form-control form-control-solid green col-md-3 col-sm-3 col-xs-6">
                                                    <option value=@Guid.Empty>Harita Formatı Seçin</option>)
                                                    @{
                                                        for (int i = 0; i < mapcount; i++)
                                                        {
                                                            <option value=@maptype[i].Id>@maptype[i].Name</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                        }
                                    }
                                    
                                    <div id="mapWrapper">
                                        @{
                                            if (MapImageError == "MapImageError" || UploadTypeError != "Correct")
                                            {
                                                if (UsageError == "UsageError")
                                                {
                                                    <div class="col-md-2 col-sm-2 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                        <select name="Usage" id="Usage" class="form-control form-control-solid red col-md-3 col-sm-3 col-xs-6">
                                                            <option value="Boş">Harita Bölgesi Seçiniz</option>)
                                                            <option value="Kroki">Otel İçi Kroki</option>
                                                            <option value="Şehir">Şehir Haritası</option>
                                                        </select>
                                                    </div>
                                                }
                                                else
                                                {
                                                    <div class="col-md-2 col-sm-2 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                        <select name="Usage" id="Usage" class="form-control form-control-solid green col-md-3 col-sm-3 col-xs-6">
                                                            <option value="Boş">Harita Bölgesi</option>)
                                                            <option value="Kroki">Otel İçi Kroki</option>
                                                            <option value="Şehir">Şehir Haritası</option>
                                                        </select>
                                                    </div>
                                                }
                                                <div class="col-md-4 col-sm-4 col-xs-8" style="padding-left: 0; padding-right: 10px; margin-bottom: 8px;">
                                                    <input class="form-control form-control-solid placeholder-no-fix btn red" type="file" id="uploadedmap" name="uploadedmap" />
                                                </div>
                                            }
                                            else
                                            {
                                                if (UsageError == "UsageError")
                                                {
                                                    <div class="col-md-2 col-sm-2 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                        <select name="Usage" id="Usage" class="form-control form-control-solid red col-md-3 col-sm-3 col-xs-6">
                                                            <option value="Boş">Harita Bölgesi Seçiniz</option>)
                                                            <option value="Kroki">Otel İçi Kroki</option>
                                                            <option value="Şehir">Şehir Haritası</option>
                                                        </select>
                                                    </div>
                                                }
                                                else
                                                {
                                                    <div class="col-md-2 col-sm-2 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                        <select name="Usage" id="Usage" class="form-control form-control-solid green col-md-3 col-sm-3 col-xs-6">
                                                            <option value="Boş">Harita Bölgesi</option>)
                                                            <option value="Kroki">Otel İçi Kroki</option>
                                                            <option value="Şehir">Şehir Haritası</option>
                                                        </select>
                                                    </div>
                                                }
                                                <div class="col-md-4 col-sm-4 col-xs-8" style="padding-left: 0; padding-right: 10px; margin-bottom: 8px;">
                                                    <input class="form-control form-control-solid placeholder-no-fix btn green" type="file" id="uploadedmap" name="uploadedmap" />
                                                </div>
                                            }
                                        }
                                    </div>

                                    <div id="coordinateWrapper" style="display:none;">
                                        @{
                                            if (LattitudeError == "LattitudeError")
                                            {
                                                <div class="col-md-3 col-sm-3 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                    @Html.EditorFor(model => model.Lattitude, new { htmlAttributes = new { @placeholder = "Geçersiz Enlem", @class = "form-control red btn-outline pull-left", @style = "color: #36c6d3" } })
                                                    <div style="color:#e73d4a;">Invalid Lattitude</div>
                                                </div>
                                            }
                                            else
                                            {
                                                <div class="col-md-3 col-sm-3 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                    @Html.EditorFor(model => model.Lattitude, new { htmlAttributes = new { @placeholder = "Enlem Örn: 39.9241", @class = "form-control green btn-outline pull-left" } })
                                                </div>
                                            }
                                        }

                                        @{
                                            if (LongitudeError == "LongitudeError")
                                            {
                                                <div class="col-md-3 col-sm-3 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                    @Html.EditorFor(model => model.Longitude, new { htmlAttributes = new { @placeholder = "Geçersiz Boylam", @class = "form-control red btn-outline pull-left", @style = "color: #36c6d3" } })
                                                    <div style="color:#e73d4a;">Invalid Longitude</div>
                                                </div>

                                            }
                                            else
                                            {
                                                <div class="col-md-3 col-sm-3 col-xs-4" style="padding-left: 0; padding-right: 10px;">
                                                    @Html.EditorFor(model => model.Longitude, new { htmlAttributes = new { @placeholder = "Boylam Örn: 32.8356", @class = "form-control green btn-outline pull-left" } })
                                                </div>
                                            }
                                        }
                                    </div>
                                    
                                    @{
                                        if (MapNameError == "MapNameError")
                                        {
                                            <div class="col-md-2 col-sm-2 col-xs-6" style="padding-left: 0; padding-right: 10px;">
                                                @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @placeholder = "Harita İsmi Girin", @class = "form-control red btn-outline pull-left", @style = "color: #36c6d3" } })
                                                @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="col-md-2 col-sm-2 col-xs-6" style="padding-left: 0; padding-right: 10px;">
                                                @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @placeholder = "Harita İsmi Girin", @class = "form-control green btn-outline pull-left" } })
                                                @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
                                            </div>
                                        }
                                    }

                                    <div class="col-md-2 col-sm-2 col-xs-6" style="padding-left: 0; padding-right: 10px;">
                                        <button type="submit" id="register-submit-btn" class="btn green btn-outline pull-left">Oluştur</button>
                                    </div> 

                                    @{
                                        if (UploadTypeError != "Correct")
                                        {
                                            <div class="row">
                                                <div class="col-md-12 col-sm-12 col-xs-12" style="color: #ed6b75; text-align: left;">
                                                    @UploadTypeError
                                                </div>
                                            </div>
                                        }
                                        else if (LattitudeError == "LattitudeError" || LongitudeError == "LongitudeError")
                                        {
                                            <div class="row">
                                                <div class="col-md-12 col-sm-12 col-xs-12" style="color: #ed6b75; text-align: left;">
                                                    Lütfen Enlem-Boylam bilgilerine dikkat edin. Örn: Lat: 39.9241 Lng: 32.8356
                                                </div>
                                            </div>
                                        }
                                    }

                                </div>
                            </div>

                        }


                        @{
                            int mapp = MapList.Count;
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                    <tr>
                                        <th> Harita </th>
                                        <th style="text-align:center; width: 120px;"> Harita Bölgesi </th>
                                        <th style="text-align:center; width: 80px;"> Sil </th>
                                    </tr>
                                </thead>
                                <tbody>


                                    @{
                                        for (int i = 0; i < mapp; i++)
                                        {
                                            String hidden = "hidden-td" + (i + 1);
                                            <tr>
                                                <td>
                                                    <a href="@Url.Action("DisplayMap","Maps",new { mapdet = @MapList[i].Id })">
                                                        @MapList[i].Name
                                                    </a>
                                                </td>
                                                @{ 
                                                    if (MapList[i].Usage == "Google")
                                                    {
                                                        <td style="text-align: center;">Google Haritası</td>
                                                    }
                                                    else if (MapList[i].Usage == "Kroki")
                                                    {
                                                        <td style="text-align: center;">Otel Krokisi</td>
                                                    }
                                                    else
                                                    {
                                                        <td style="text-align: center;">Şehir Haritası</td>
                                                    }
                                                }
                                                <td class="pull-left-right delete-type1" data-td="@hidden" style="text-align:center; cursor:pointer;"> Kaldır </td>
                                            </tr>

                                            // Burası delete için

                                            using (Html.BeginForm())
                                            {
                                                @Html.AntiForgeryToken()
                                                <tr>
                                                    <td class="display-none @hidden">
                                                        <div style="float: left; margin-top: 8px;">
                                                            @MapList[i].Name silmek istediğinize emin misiniz?
                                                        </div>
                                                    </td>
                                                    <td class="display-none @hidden">
                                                        <a href="/Maps/CreateMap" id="continue-btn" class="btn btn-default pull-right" style="text-align:center; margin:0px; margin-right: 8px; border-color: #36c6d3; color: #36c6d3"> Hayır </a>
                                                    </td>
                                                    <td class="display-none @hidden">
                                                        <a class="btn btn-default green" style="margin-left: 8px; margin-right: 0px;" href="@Url.Action("DeleteApprove","Maps",new { id = MapList[i].Id })">
                                                            Evet
                                                        </a>
                                                    </td>
                                                </tr>
                                            }

                                        }
                                    }

                                </tbody>
                            </table>
                        }

                    </div>
                </div>
                <!-- END EXAMPLE TABLE PORTLET-->
            </div>
        </div>
    </div>
    <!-- END CONTENT BODY -->
</div>


<!-- BEGIN CORE PLUGINS -->
<script src="../assets/global/plugins/jquery.min.js" type="text/javascript"></script>
<script src="../assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../assets/global/plugins/js.cookie.min.js" type="text/javascript"></script>
<script src="../assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
<script src="../assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
<script src="../assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
<!-- END CORE PLUGINS -->
<!-- BEGIN PAGE LEVEL PLUGINS -->
<script src="../assets/global/scripts/datatable.js" type="text/javascript"></script>
<script src="../assets/global/plugins/datatables/datatables.min.js" type="text/javascript"></script>
<script src="../assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js" type="text/javascript"></script>
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN THEME GLOBAL SCRIPTS -->
<script src="../assets/global/scripts/app.min.js" type="text/javascript"></script>
<!-- END THEME GLOBAL SCRIPTS -->
<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script src="../assets/pages/scripts/table-datatables-editable.min.js" type="text/javascript"></script>
<!-- END PAGE LEVEL SCRIPTS -->
<!-- BEGIN THEME LAYOUT SCRIPTS -->
<script src="../assets/layouts/layout/scripts/layout.min.js" type="text/javascript"></script>
<script src="../assets/layouts/layout/scripts/demo.min.js" type="text/javascript"></script>
<script src="../assets/layouts/global/scripts/quick-sidebar.min.js" type="text/javascript"></script>
<!-- END THEME LAYOUT SCRIPTS -->
