@using Cake.Controllers
@using System.Data

@{
    DatabaseController dc = new DatabaseController();
    UtilityController uc = new UtilityController();
    DataTable bakeries = dc.DBQueryGetter("select * from BakeryTrial");
}

<script>

    var imgExists = false;

    function ValidateAddBakery() {
        var addBakeryValidated = true;
        var addBakeryForms = $("#admin-addbakery-form input[type=text], #admin-addbakery-form textarea , #admin-addbakery-form input[type=password]");
        for (i = 0; i < addBakeryForms.length; i++) {
            if ($(addBakeryForms[i]).val().length == 0) { $(addBakeryForms[i]).css("border-color", "red"); addBakeryValidated = false; }
            else { $(addBakeryForms[i]).css("border-color", "#e6e6e6"); }
        }

        if (imgExists == false) {
            $("#addBakeryLogo").css("border-color", "red"); addBakeryValidated = false;
        }

        if (addBakeryValidated == false) { event.preventDefault(); }
    }

    $(document).ready(function () {

        $("#addBakeryPhoto").change(function () {

            if (this.files && this.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $('#addBakeryLogo').attr('src', e.target.result);
                    $("#addBakeryLogo").css("border-color", "#e6e6e6");
                    imgExists = true;
                }
                reader.readAsDataURL(this.files[0]);
            }
        });
    });

</script>

<div class="container" style="min-height:50vh;">

    <div style="width:100%; float:left; border-bottom:1px dashed #3f2518; margin-bottom:30px !important; padding:15px 0px; padding-top:0px;">
        <label style="float:left; font-size:18px;   text-align:left; color:#3f2518; line-height:initial;">Pastaneler</label>
    </div>

    <div class="col-md-12 col-sm-12 col-xs-12 pastaneler-grid" style="float:left; padding:2px; background:#f0f0f0; margin-bottom:20px;">
        <div class="row">
            @{
                for (int i = 0; i < bakeries.Rows.Count; i++)
                {
                    DataRow bakery = bakeries.Rows[i];
                    String img = "/Images/Bakery/" + bakery["Thumbnail"];
                    String bakeryDelivery = "Var"; String bdStyle = "color:green;";
                    String homeDelivery = "Var"; String hdStyle = "color:green;";
                    String isOpen = "Açık"; String ioStyle = "color:green;";
                    if (bakery["BakeryDelivery"].ToString() == "no") { bakeryDelivery = "Yok"; bdStyle = "color:red;"; }
                    if (bakery["HomeDelivery"].ToString() == "no") { homeDelivery = "Yok"; hdStyle = "color:red;"; }
                    if (bakery["isOpen"].ToString() == "0") { isOpen = "Kapalı"; ioStyle = "color:red;"; }
                    String offset = "";
                    if (i == 0) { double temp = (12 - (bakeries.Rows.Count * 2)) / 2; if (temp >= 1) { offset = "col-md-offset-" + temp; } }

                    <div class="col-md-12 col-sm-12 col-xs-12 pastane-elem" style="background:white; text-align:center; cursor:pointer; padding:15px 0px; float:left;">
                        <div class="col-md-1 col-sm-2 hidden-xs" style="float:left; padding-right:0px;">
                            <img alt="pastane resmi" src="@img" style="width:75px;" />
                        </div>
                        <div class="col-md-11 col-sm-10 col-xs-12" style="float:left;">
                            <div style="width:100%; float:left; text-align:center;">
                                <h2 style="float:left; text-align:center; color:black; font-weight:400; font-size:30px; margin:0px; line-height:45px;">@bakery["Name"] <span style="font-size:16px; line-height:50px; float:right; padding-left:10px;"> - @dc.getNameFromId(bakery["Province"].ToString(), "Province")</span></h2>
                                <img alt="pastane menüsünü aç" src="~/Images/Site/down.png" onclick="$(this).parent().parent().parent().find('.bakeryInfoDiv').slideToggle(300)" style="float:left; padding:0px 12px; width:36px; margin-top:18px;" />
                            </div>
                        </div>
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="bakeryInfoDiv" style="width:100%; float:left; padding:10px 0px; margin-top:10px; text-align:center; font-size:12px; border-top:1px solid #e6e6e6; display:none;">
                                <div style="float:left; width:110px;">
                                    <label style="float:left; width:100%; color:#3f2518; font-weight:500; text-align:left; padding:3px 0px;">Durum :</label>
                                    <label style="float:left; width:100%; color:#3f2518; font-weight:500; text-align:left; padding:3px 0px;">Min. Paket Tutarı :</label>
                                    <label style="float:left; width:100%; color:#3f2518; font-weight:500; text-align:left; padding:3px 0px;">En Erken Sipariş :</label>
                                    <label style="float:left; width:100%; color:#3f2518; font-weight:500; text-align:left; padding:3px 0px;">Şubede Ödeme :</label>
                                    <label style="float:left; width:100%; color:#3f2518; font-weight:500; text-align:left; padding:3px 0px;">Kapıda Ödeme :</label>
                                </div>
                                <div style="float:left; width:50%;">
                                    <label style="float:left; width:100%; font-weight:500; text-align:left; padding:3px 0px; @ioStyle">@isOpen</label>
                                    <label style="float:left; width:100%; font-weight:500; text-align:left; padding:3px 0px;">@bakery["MinPacket"] TL</label>
                                    <label style="float:left; width:100%; font-weight:500; text-align:left; padding:3px 0px;">@bakery["EarliestDelivery"] Saat</label>
                                    <label style="float:left; width:100%; font-weight:500; text-align:left; padding:3px 0px; @bdStyle">@bakeryDelivery</label>
                                    <label style="float:left; width:100%; font-weight:500; text-align:left; padding:3px 0px; @hdStyle">@homeDelivery</label>
                                </div>
                                <div style="width:100%;">
                                    <label style="float:left; width:100%; font-weight:500; color:#3f2518; text-align:left; padding:3px 0px;">Adres :</label>
                                    <label style="float:left; width:100%; font-weight:500; text-align:left; padding:3px 0px; font-size:16px;">@bakery["SpecificAddress"]</label>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>
    </div>

    <div class="col-md-12 col-sm-12 col-xs-12" style="padding:0px;">

        <label class="black-gradient" onclick="$('#admin-addbakery-form').slideToggle(500);" style="margin-bottom:30px !important; font-size:18px;">Yeni Pastane Ekle</label>

        @using (Html.BeginForm("AddBakery", "Bakery", FormMethod.Post, new { enctype = "multipart/form-data", id = "admin-addbakery-form", style = "display:none;", onsubmit = "ValidateAddBakery()" }))
        {
            <label style="width:100%; float:left; font-size:24px; padding:20px 0px;">Yeni Pastane Formu</label>

            <label style="width:100%; float:left; font-size:13px; margin-bottom:20px !important;">Fiyat girilirken her zaman nokta kullanılmalıdır. <br /> E-Posta birden fazla olacaksa boşluklu girilmelidir. <br /> Yüklenecek resimler her zaman 300x500 olmalıdır. <br /> Açıklama, adres ve isimde <> benzeri karakterler bulunmamalıdır. <br /> Teslimat saati saat cinsindendir Örn. 1 <br /> Tasarım teslimat saati Örn. 18:00 24 11:00 cinsinden girilmelidir. Yani saat 18:00'den sonra alınan siparişler en erken 24 saat sonra saat 11:00'da teslim edilir. <br /> Çalışma saatleri 9:00 - 23:00 cinsinden girilmelidir. <br /> Büyük-Küçük harf duyarlıdır. <br /> Noktalamalara dikkat edilmelidir yoksa hata verebilir.</label>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryUsername" id="addBakeryUsername" onkeyup="validateKeyup(this)" placeholder="Kullanıcı Adı" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="password" name="addBakeryPassword" id="addBakeryPassword" onkeyup="validateKeyup(this)" placeholder="Şifre" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryName" id="addBakeryName" onkeyup="validateKeyup(this)" placeholder="İsim" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryTel" id="addBakeryTel" onkeyup="validateKeyup(this)" placeholder="Telefon" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryMail" id="addBakeryMail" onkeyup="validateKeyup(this)" placeholder="E-Posta" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <textarea type="text" name="addBakeryDesc" id="addBakeryDesc" onkeyup="validateKeyup(this)" placeholder="Açıklama" class="admin-bakery-input" autocomplete="off"></textarea>
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryAddress" id="addBakeryAddress" onkeyup="validateKeyup(this)" placeholder="Adres" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryKeywords" id="addBakeryKeywords" onkeyup="validateKeyup(this)" placeholder="Keywords Örn. liva, liva ankara, pasta siparişi ankara" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryCakePrice" id="addBakeryCakePrice" onkeyup="validateKeyup(this)" placeholder="Pasta Birim Fiyat Örn. 15.00" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryCupcakePrice" id="addBakeryCupcakePrice" onkeyup="validateKeyup(this)" placeholder="Cupcake Birim Fiyat Örn. 12.00" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryCookiePrice" id="addBakeryCookiePrice" onkeyup="validateKeyup(this)" placeholder="Cookie Birim Fiyat Örn. 10.00" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryWorkhours" id="addBakeryWorkhours" onkeyup="validateKeyup(this)" placeholder="Çalışma saatleri Örn. 9.00 - 23.00" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryDesignWorkhours" id="addBakeryDesignWorkhours" onkeyup="validateKeyup(this)" placeholder="Tasarım Pasta Çalışma saatleri Örn. 11.00 - 20.00" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <input type="text" name="addBakeryEarliest" id="addBakeryEarliest" onkeyup="validateKeyup(this)" placeholder="En erken teslimat (saat)" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left; margin-bottom:10px;">
                <input name="addBakeryEarliestDesign" id="addBakeryEarliestDesign" type="text" onkeyup="validateKeyup(this)" placeholder="En erken teslimat tasarım Örn. 18:00 24 11:00" class="admin-bakery-input" autocomplete="off" />
            </div>

            <div style="width:100%; float:left;">
                <div style="width:300px; float:left; margin-bottom:15px;">
                    <label style="float:left; padding-left:10px;">Adrese Teslimat</label>
                    <input name="addBakeryHD" id="addBakeryHD" style="float:right; height:20px; width:20px; margin-right:10px;" type="checkbox" />
                </div>
            </div>

            <div style="width:100%; float:left;">
                <div style="width:300px; float:left; margin-bottom:15px;">
                    <label style="float:left; padding-left:10px;">Pastaneden Teslimat</label>
                    <input name="addBakeryBD" id="addBakeryBD" style="float:right; height:20px; width:20px; margin-right:10px;" type="checkbox" />
                </div>
            </div>

            <div style="width:100%; float:left;">
                <input name="addBakeryPhoto" id="addBakeryPhoto" type="file" style="display:none;" />
                <div style="width:100%; float:left; ">
                    <label for="addBakeryPhoto" class="black-gradient" style="font-size:14px; width:150px; margin-left:75px; text-align:center;">Resim Yükle</label>
                </div>
                <label style="float:left; width:300px; padding:10px; text-align:center;">Resmin boyutları 300x500 olmalıdır.</label>
            </div>

            <div style="width:100%; float:left; margin-bottom:20px;">
                <img src="" id="addBakeryLogo" style="width:300px; height:180px; float:left; border:1px solid #e6e6e6; border-radius:10px; padding:5px;" />
            </div>

            <div style="width:100%; float:left; margin-top:5px; margin-bottom:20px;">
                <input type="submit" class="black-gradient" value="Ekle" style="width:300px; text-align:center; float:left;" />
            </div>
        }

    </div>

</div>


